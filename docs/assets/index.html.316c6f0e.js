import{_ as l,r as c,o as i,c as r,a as n,d as a,w as t,b as s,e as o}from"./app.f76b6b22.js";var u="/php-next2-docs/img/layers/200.png?style=centerme",d="/php-next2-docs/img/layers/401.png?style=centerme";const k={},v=n("h1",{id:"\u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430\u0446\u0438\u044F",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430\u0446\u0438\u044F","aria-hidden":"true"},"#"),s(" \u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430\u0446\u0438\u044F")],-1),h={class:"table-of-contents"},b=s("Hello World"),g=s("\u0413\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0439"),m=s("\u0421\u043B\u043E\u0438"),_=s("Handler"),y=s("Options"),w=s("\u0411\u044B\u0441\u0442\u0440\u044B\u0435 http \u043C\u0435\u0442\u043E\u0434\u044B (\u0441\u0430\u0445\u0430\u0440)"),f=s("\u0414\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F \u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F"),x=s("Flow"),$=s("PSR-15 Middleware"),q=s("\u0418\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F"),P=s("TODO"),R=n("hr",null,null,-1),S={class:"custom-container tip"},T=n("p",{class:"custom-container-title"},"\u041F\u0440\u0435\u0434\u044B\u0441\u0442\u043E\u0440\u0438\u044F",-1),C=s("Next2 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043F\u0435\u0440\u0435\u0440\u0430\u0431\u043E\u0442\u043A\u043E\u0439 \u0431\u043E\u043B\u0435\u0435 \u0440\u0430\u043D\u043D\u0435\u0439 \u0431\u0438\u0431\u043B\u0438\u043E\u0442\u0435\u043A\u0438 "),L={href:"https://github.com/alexpts/psr15-next/",target:"_blank",rel:"noopener noreferrer"},M=s("psr15-next"),H=s(". \u041F\u0435\u0440\u0432\u0430\u044F \u0432\u0435\u0440\u0441\u0438\u044F \u0431\u044B\u043B\u0430 \u043D\u0430\u043F\u0438\u0441\u0430\u043D\u0430 \u0434\u043B\u044F \u043F\u0440\u043E\u0441\u0442\u043E\u0439, \u0433\u0438\u0431\u043A\u043E\u0439 \u0438 \u0431\u044B\u0441\u0442\u0440\u043E\u0439 \u0440\u0430\u0431\u043E\u0442\u044B \u0441 "),N={href:"https://www.php-fig.org/psr/psr-15/",target:"_blank",rel:"noopener noreferrer"},I=s("PSR-15 middleware"),E=s(" \u0432 \u0441\u0442\u0438\u043B\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0439 \u043D\u0430 \u0444\u0440\u0435\u0439\u043C\u0432\u043E\u0440\u043A\u0435 "),A={href:"https://koajs.com/",target:"_blank",rel:"noopener noreferrer"},J=s("KoaJs"),G=s(", \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u0432 \u0441\u0432\u043E\u044E \u043E\u0447\u0435\u0440\u0435\u0434\u044C \u043E\u0447\u0435\u043D\u044C \u043F\u043E\u0445\u043E\u0436 \u043D\u0430 "),O={href:"https://expressjs.com/",target:"_blank",rel:"noopener noreferrer"},F=s("ExpressJs"),j=s("."),U=o(`<h2 id="hello-world" tabindex="-1"><a class="header-anchor" href="#hello-world" aria-hidden="true">#</a> Hello World</h2><p>\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0441 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u043E\u0439 PSR-7 \u043D\u0430 <strong>Next2</strong> \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u0442\u0430\u043A:</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>Context<span class="token punctuation">\\</span>ContextInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>MicroApp</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Psr7<span class="token punctuation">\\</span>Response<span class="token punctuation">\\</span>JsonResponse</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Psr7<span class="token punctuation">\\</span>ServerRequest</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Psr7<span class="token punctuation">\\</span>Uri</span><span class="token punctuation">;</span>

<span class="token keyword">require_once</span> <span class="token string single-quoted-string">&#39;../../../vendor/autoload.php&#39;</span><span class="token punctuation">;</span>

<span class="token variable">$psr7Request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerRequest</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;GET&#39;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Uri</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$app</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MicroApp</span><span class="token punctuation">;</span>

<span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">store</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token class-name type-declaration">ContextInterface</span> <span class="token variable">$ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$ctx</span><span class="token operator">-&gt;</span><span class="token property">response</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JsonResponse</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;message&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Hello World!&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$psr7Response</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token variable">$psr7Request</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// psr-15 runner</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u0433\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0438" tabindex="-1"><a class="header-anchor" href="#\u0433\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0438" aria-hidden="true">#</a> \u0413\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0439</h2><h4 id="\u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435" tabindex="-1"><a class="header-anchor" href="#\u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435" aria-hidden="true">#</a> \u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435</h4><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u0441\u0430\u043C\u044B\u043C \u0432\u044B\u0441\u043E\u043A\u0438\u043C \u0443\u0440\u043E\u0432\u043D\u0435\u043C \u0438 \u0440\u0435\u0430\u043B\u0437\u0438\u0443\u0435\u0442 \u043F\u043E\u043B\u043D\u043E\u0443\u044E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0430. \u0417\u0430\u0434\u0430\u0447\u0430 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043D\u0430 \u0432\u0445\u043E\u0434\u0435 http request \u0438 \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response.</p><h4 id="middleware-\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A-\u043F\u0440\u043E\u043C\u0435\u0436\u0443\u0442\u043E\u0447\u043D\u043E\u0433\u043E-\u0443\u0440\u043E\u0432\u043D\u044F" tabindex="-1"><a class="header-anchor" href="#middleware-\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A-\u043F\u0440\u043E\u043C\u0435\u0436\u0443\u0442\u043E\u0447\u043D\u043E\u0433\u043E-\u0443\u0440\u043E\u0432\u043D\u044F" aria-hidden="true">#</a> Middleware (\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A \u043F\u0440\u043E\u043C\u0435\u0436\u0443\u0442\u043E\u0447\u043D\u043E\u0433\u043E \u0443\u0440\u043E\u0432\u043D\u044F)</h4>`,7),V=s("\u0427\u0430\u0441\u0442\u044C \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u043E\u0442\u0447\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043A\u043E\u043D\u043A\u0440\u0435\u0442\u043D\u0443\u044E \u0435\u0434\u0438\u043D\u0438\u0446\u0443 \u043B\u043E\u0433\u0438\u043A\u0438 \u0432 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435 request/response. ("),W={href:"https://www.php-fig.org/psr/psr-15/",target:"_blank",rel:"noopener noreferrer"},B=s("PSR-15 middleware"),Z=s(")"),z={class:"custom-container tip"},D=n("p",{class:"custom-container-title"},"\u041E\u0442\u0441\u044B\u043B\u043A\u0430 \u043A PSR-15",-1),K=s("\u041F\u0435\u0440\u0432\u043E\u0439 \u0432\u0435\u0440\u0441\u0438\u044F \u0444\u0440\u0435\u0439\u043C\u0432\u043E\u0440\u043A\u0430 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043B\u0430 "),Q={href:"https://www.php-fig.org/psr/psr-15/",target:"_blank",rel:"noopener noreferrer"},X=s("PSR-15 middleware"),Y=s(". Next2 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u044E\u0442 \u043F\u043E\u0445\u043E\u0436\u0443\u044E \u043D\u0430 "),nn=n("code",null,"PSR-15",-1),sn=s(" \u043F\u043E \u0441\u043C\u044B\u0441\u043B\u0443 \u0438 \u0441\u0438\u0433\u043D\u0430\u0442\u0443\u0440\u0435 \u043C\u043E\u0434\u0435\u043B\u044C \u0432\u044B\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u043D\u0438\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u043E\u0432."),an=n("p",null,"\u041E\u0442\u043B\u0438\u0447\u0438\u044F \u043E\u0442 PSR-15 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u043E\u0432:",-1),en=n("ul",null,[n("li",null,[s("\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u043E\u043C \u043F\u0440\u043E\u043C\u0435\u0436\u0443\u0442\u043E\u0447\u043D\u043E\u0433\u043E \u0443\u0440\u043E\u0432\u043D\u044F \u0432\u044B\u0441\u0442\u0443\u043F\u0430\u0435\u0442 \u043B\u044E\u0431\u043E\u0439 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A \u0441 \u0442\u0438\u043F\u043E\u043C "),n("code",null,"callable"),s(" \u0432\u043C\u0435\u0441\u0442\u043E "),n("code",null,"Psr\\Http\\Server\\MiddlewareInterface"),s(".")]),n("li",null,[s("Layer \u043C\u043E\u0436\u0435\u0442 \u0437\u0430\u043F\u0443\u0441\u043A\u0430\u0442\u044C \u043D\u0435 1 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A, \u0430 \u0433\u0440\u0443\u043F\u043F\u0443 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u043E\u0432 "),n("code",null,"callable[]"),s(", \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u044F \u0434\u0435\u043B\u0438\u0442\u044C \u043A\u043E\u0434 \u043D\u0430 \u0431\u043E\u043B\u0435\u0435 \u043C\u0435\u043B\u043A\u0438\u0435 \u0447\u0430\u0441\u0442\u0438 \u0441\u043E\u0445\u0440\u0430\u043D\u044F\u044F \u043B\u043E\u0433\u0438\u0447\u0435\u0441\u043A\u0443\u044E \u0446\u0435\u043B\u043E\u0441\u0442\u043D\u043E\u0441\u0442\u044C.")])],-1),tn=o(`<h4 id="layer-\u0441\u043B\u043E\u0438" tabindex="-1"><a class="header-anchor" href="#layer-\u0441\u043B\u043E\u0438" aria-hidden="true">#</a> Layer / \u0421\u043B\u043E\u0439</h4><p>\u042D\u0442\u043E \u0430\u0431\u0441\u0442\u0440\u0430\u043A\u0446\u0438\u044F \u043D\u0430\u0434 middleware \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u043E\u043C, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u0442 \u043C\u0435\u0442\u0430\u0438\u043D\u0444\u043E\u0440\u043C\u0446\u0438\u044E (\u0434\u043B\u044F \u043F\u0440\u043E\u0441\u0442\u043E\u0442\u044B \u044D\u0442\u043E \u043C\u043E\u0436\u043D\u043E \u0441\u0447\u0438\u0442\u0430\u0442\u0430\u0442\u044C \u0430\u043B\u0438\u0430\u0441\u043E\u043C middleware). \u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u044D\u0442\u043E \u043D\u0430\u0431\u043E\u0440 Layers, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u044E\u0442\u0441\u044F \u0434\u043B\u044F \u043A\u0430\u0436\u0434\u043E\u0433\u043E http \u0437\u0430\u043F\u0440\u043E\u0441\u0430.</p><hr><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u043E\u0441\u043E\u0437\u043D\u0430\u043D\u043E \u0441\u0432\u043E\u0434\u0438\u0442 \u0447\u0438\u0441\u043B\u043E \u0441\u0443\u0449\u043D\u043E\u0441\u0442\u0435\u0439 \u043A \u043C\u0438\u043D\u0438\u043C\u0443\u043C\u0443, \u0447\u0442\u043E\u0431\u044B \u043E\u0441\u0442\u0430\u0432\u0430\u0442\u044C\u0441\u044F \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u043F\u0440\u043E\u0441\u0442\u044B\u043C, \u043F\u043E\u043D\u044F\u0442\u043D\u044B\u043C \u0438 \u043D\u0430\u0434\u0435\u0436\u043D\u044B\u043C. \u041E\u0441\u043D\u043E\u0432\u043D\u043E\u0435 \u043F\u043E\u043D\u044F\u0442\u0438\u0435 \u0441 \u043A\u043E\u0442\u043E\u0440\u044B\u043C \u043F\u0440\u0438\u0434\u0435\u0442\u0441\u044F \u043F\u043E\u0441\u0442\u043E\u044F\u043D\u043D\u043E \u0440\u0430\u0431\u043E\u0442\u0430\u0442\u044C \u044D\u0442\u043E Layer (\u0421\u043B\u043E\u0439). Layer \u044D\u0442\u043E \u0430\u0431\u0441\u0441\u0442\u0440\u0430\u043A\u0446\u0438\u044F \u043D\u0430\u0434 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u043E\u043C, \u043A\u043E\u0442\u043E\u044B\u0440\u0439 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043B\u0435\u043D \u043B\u044E\u0431\u044B\u043C \u0441\u043F\u043E\u0441\u043E\u0431\u043E\u043C \u0438 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0432\u0443\u0435\u0442 \u0442\u0438\u043F\u0443 <code>callable</code> \u0432 PHP.</p><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u0438\u043D\u0435 \u043F\u043E\u043B\u0443\u0447\u0430\u0435\u0442 \u043D\u0430 \u0432\u0445\u043E\u0434 \u0441\u0442\u0430\u043D\u0434\u0430\u0440\u0442\u043D\u044B\u0439 \u043E\u0431\u044A\u0435\u043A\u0442 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 <code>PSR-7</code> \u0438 \u043F\u0440\u043E\u0433\u043E\u043D\u044F\u0435\u0442 \u0447\u0435\u0440\u0435\u0437 \u0432\u0441\u0435 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0438 \u0441\u043B\u043E\u0435\u0432. \u041A\u0430\u043A\u0438\u0435 \u0438\u043C\u0435\u043D\u043D\u043E \u0441\u043B\u043E\u0438 \u043F\u0440\u0438\u043C\u0443\u0442 \u0447\u0430\u0441\u0442\u0438\u0435 \u0432 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0435\u0442\u0430\u0438\u0444\u043D\u043E\u0440\u043C\u0430\u0446\u0438\u0435\u0439 \u0441\u043B\u043E\u044F. \u0421\u0435\u043C\u0430\u043D\u0442\u0438\u0447\u0435\u0441\u043A\u0438 \u043C\u043E\u0436\u043D\u043E \u0432\u044B\u0434\u0435\u043B\u0438\u0442\u044C \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0435 \u0442\u0438\u043F\u044B \u0441\u043B\u043E\u0435\u0432:</p><ul><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u043C \u0437\u0430\u043F\u0440\u043E\u0441\u0435</li><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043F\u043E http \u043C\u0435\u0442\u043E\u0434\u0443</li><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043F\u043E \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u044E uri \u0432 \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u043E\u043C \u0432\u044B\u0440\u0430\u0436\u0435\u043D\u0438\u0438</li></ul><details class="custom-container details"><summary>\u0421\u043E\u0431\u0441\u0442\u0432\u0435\u043D\u043D\u044B\u0435 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438</summary><p>\u0418\u0437 \u043A\u043E\u0440\u043E\u0431\u043A\u0438 \u0438\u0434\u0435\u0442 \u043C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u043D\u0430\u0431\u043E\u0440 \u0441\u0442\u0440\u0430\u0442\u0435\u043D\u0438\u0439 (\u043F\u043E http \u043C\u0435\u0442\u043E\u0434\u0443 \u0438 \u043F\u043E\u0438\u0441\u043A \u043F\u043E uri). \u041C\u043E\u0436\u043D\u043E \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u0442\u044C \u043B\u044E\u0431\u044B\u0435 \u043A\u0430\u0441\u0442\u043E\u043C\u043D\u044B\u0435 \u043F\u0440\u0430\u0432\u0438\u043B\u0430, \u043F\u043E \u043A\u043E\u0442\u043E\u0440\u044B\u043C \u0431\u0443\u0434\u0435\u0442 \u043F\u0440\u0438\u043D\u044F\u0442\u043E \u0440\u0435\u0448\u0435\u0438\u043D\u0435 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u044F \u0441\u043B\u043E\u0439 \u0434\u043B\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 request \u0438\u043B\u0438 \u043D\u0435\u0442. \u0414\u043B\u044F \u044D \u0442\u043E\u0433\u043E \u043D\u0443\u0436\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0432\u043E\u044E \u0440\u0435\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044E <code>PTS\\Next2\\Layer\\Resolver\\LayerResolverInterface</code></p></details><h2 id="\u0441\u043B\u043E\u0438" tabindex="-1"><a class="header-anchor" href="#\u0441\u043B\u043E\u0438" aria-hidden="true">#</a> \u0421\u043B\u043E\u0438</h2><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 <code>MicroApp</code> \u0445\u0440\u0430\u043D\u0438\u0442 \u0432 \u0441\u0435\u0431\u0435 \u0432 \u0441\u0432\u043E\u0439\u0441\u0442\u0432\u0435 <code>$app-&gt;store</code> \u0445\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 \u0441\u043B\u043E\u0435\u0432 <code>LayersStore</code>. \u0425\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 \u0441\u043B\u043E\u0435\u0432 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0447\u0442\u0438\u043A\u0438 \u043A \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044E \u043F\u043E\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043E\u043C \u043C\u0435\u0442\u043E\u0434\u0430 <code>use</code>:</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code>    <span class="token doc-comment comment">/**
     * <span class="token keyword">@param</span> <span class="token class-name">callable<span class="token punctuation">[</span><span class="token punctuation">]</span></span> | callable $handler
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">use</span><span class="token punctuation">(</span><span class="token keyword">callable</span><span class="token operator">|</span><span class="token keyword type-declaration">array</span> <span class="token variable">$handler</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">static</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$layer</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">layerFactory</span><span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$handler</span><span class="token punctuation">,</span> <span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token variable">$layer</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="handler" tabindex="-1"><a class="header-anchor" href="#handler" aria-hidden="true">#</a> Handler</h3><p>\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u043E\u043C \u043C\u043E\u0436\u0435\u0442 \u0432\u044B\u0441\u0442\u0443\u043F\u0430\u0442\u044C \u043B\u044E\u0431\u0430\u044F \u0444\u043E\u0440\u043C\u0430 <code>callable</code> PHP \u0442\u0438\u043F\u0430. \u0424\u0443\u043D\u043A\u0446\u0438\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A \u0432 \u043E\u0431\u0449\u0435\u043C \u0441\u043B\u0443\u0447\u0430\u0435 \u043F\u0440\u0438\u043D\u043C\u0430\u0435\u0442 2 \u0430\u0440\u0433\u0443\u043C\u0435\u043D\u0442\u0430. \u041F\u0435\u0440\u0432\u044B\u0439 \u0430\u0440\u0433\u0443\u043C\u0435\u043D\u0442 \u044D\u0442\u043E \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u0434\u043E\u043B\u0436\u043D\u0435\u043D \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u044B\u0432\u0430\u0442\u044C <code>PTS\\Next2\\Context\\ContextInterface</code> \u043B\u0438\u0431\u043E \u0435\u0433\u043E \u043D\u0430\u0441\u043B\u0435\u0434\u043D\u0438\u043A\u043E\u0432 \u0432 \u0441\u043B\u0443\u0447\u0430\u0435 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u0438\u044F \u0431\u0430\u0437\u043E\u0432\u043E\u0433\u043E \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442\u0430 \u043F\u043E\u0434 \u0441\u0435\u0431\u044F.</p>`,12),pn={class:"custom-container tip"},on=n("p",{class:"custom-container-title"},"Context",-1),cn=s("\u041A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 - \u044D\u0442\u043E \u0441\u0432\u044F\u0437\u0443\u044E\u0449\u0430\u044F \u0447\u0430\u0441\u0442\u044C \u043C\u0435\u0436\u0434\u0443 \u0432\u0441\u0435\u043C\u0438 \u0441\u043B\u043E\u044F\u043C\u0438. \u0411\u0430\u0437\u043E\u0432\u044B\u0439 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 \u0445\u0440\u0430\u043D\u0438\u0442 request, response \u0438 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u0434\u043E\u0441\u0442\u0443\u043F \u043A \u0442\u0435\u043A\u0443\u0449\u0435\u043C\u0443 \u0441\u043B\u043E\u044E (Layer) \u0432 runtime. \u0412 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442\u0435 \u043C\u043E\u0436\u043D\u043E \u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0432\u0441\u0435 \u0447\u0442\u043E \u0443\u0433\u043E\u0434\u043D\u043E, \u0440\u0430\u0441\u0448\u0438\u0440\u044F\u044F \u0435\u0433\u043E \u0434\u043E\u0447\u0435\u0440\u043D\u0438\u043C \u043A\u043B\u0430\u0441\u0441\u043E\u043C \u0438 \u043D\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0438\u0432\u0430\u044F \u0441\u0435\u0431\u044F. \u0414\u0430\u043D\u043D\u044B\u0439 \u043F\u043E\u0434\u0445\u043E\u0434 \u0445\u043E\u0440\u043E\u0448\u043E \u0441\u0435\u0431\u044F \u0437\u0430\u0440\u0435\u043A\u043E\u043C\u0435\u043D\u0434\u043E\u0432\u0430\u043B \u0432 \u0442\u0430\u043A\u0438\u0445 \u0444\u0440\u0435\u0439\u043C\u0432\u043E\u0440\u043A\u0430\u0445 \u043A\u0430\u043A "),ln={href:"https://koajs.com/",target:"_blank",rel:"noopener noreferrer"},rn=s("koaJs"),un=s(" \u0438 "),dn={href:"https://gofiber.io/",target:"_blank",rel:"noopener noreferrer"},kn=s("goFiber"),vn=s("."),hn=o(`<p>\u0412\u0442\u043E\u0440\u043E\u0439 \u0430\u0440\u0433\u043A\u043C\u0435\u043D\u0442 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u0444\u0443\u043D\u043A\u0446\u0438\u044F <code>callable $next</code>, \u043A\u043E\u0442\u043E\u0440\u0443\u044E \u043D\u0443\u0436\u043D\u043E \u0432\u044B\u0437\u044B\u0432\u0430\u0442\u044C, \u0435\u0441\u043B\u0438 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F \u043F\u0435\u0440\u0435\u0434\u0430\u0442\u044C \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C\u0443 \u0441\u043B\u043E\u044E.</p><div class="custom-container tip"><p class="custom-container-title">Middleware \u043F\u043E\u0434\u0445\u043E\u0434</p><p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043E\u0439 \u0438\u043C\u0435\u0435\u0442 1 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043D\u0443\u044E \u0437\u043E\u043D\u0443 \u043E\u0442\u0432\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0441\u0442\u0438, \u044D\u0442\u043E \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043E\u0441\u0442\u0430\u0432\u0430\u0442\u044C\u0441\u044F \u0432\u0430\u0448\u0435\u043C\u0443 \u043A\u043E\u0434\u0443 \u043F\u0440\u043E\u0441\u0442\u044B\u043C \u0438 \u0447\u0438\u0441\u0442\u044B\u043C. \u0421\u043B\u043E\u0439 \u043C\u043E\u0436\u0435\u0442 \u0441\u0430\u043C\u043E\u0441\u0442\u043E\u044F\u0442\u0435\u043B\u044C\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0438 \u043D\u0435 \u043F\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044C \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C\u0443 \u0441\u043B\u043E\u044E. \u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440 \u0441\u043B\u043E\u0439, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043F\u0440\u043E\u0432\u0435\u0440\u044F\u0435\u0442 \u0430\u0443\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u044E, \u043C\u043E\u0436\u0435\u0442 \u0441\u0430\u043C \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0441 \u0441\u0442\u0430\u0442\u0443\u0441 \u043A\u043E\u0434\u043E\u043C <code>401</code> \u0441 \u0442\u0435\u043A\u0441\u0442\u043E\u043C \u043E\u0448\u0438\u0431\u043A\u0438, \u0447\u0442\u043E \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F \u0430\u0443\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u044F. \u0421 \u0442\u0430\u043A\u0438\u043C \u043F\u043E\u0434\u0445\u043E\u0434\u043E\u043C, \u043C\u044B \u043C\u043E\u0436\u0435\u043C \u043E\u0447\u0435\u043D\u044C \u0431\u044B\u0441\u0442\u0440\u043E \u043E\u0431\u0440\u0430\u0431\u0430\u0442\u044B\u0432\u0430\u0442\u044C \u043D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u044B, \u0434\u0430\u0436\u0435 \u043D\u0435 \u043F\u043E\u0434\u043D\u0438\u043C\u0430\u044F \u0442\u044F\u0436\u0435\u043B\u044B\u0439 \u0444\u0440\u0435\u0439\u043C\u0432\u043E\u0440, \u0435\u0441\u043B\u0438 \u043E\u043D \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u0442\u0441\u044F \u043D\u0430 \u043F\u043E\u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0445 \u0441\u043B\u043E\u044F\u0445.</p><p>\u0414\u0440\u0443\u0433\u043E\u0439 \u043F\u0440\u0438\u043C\u0435\u0440, \u044D\u0442\u043E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043C\u043E\u0436\u0435\u0442 \u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0437\u0430\u043F\u0440\u043E\u0441 \u0438 \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u043E\u0447\u0435\u043D\u044C \u0431\u044B\u0441\u0442\u0440\u043E \u043E\u0442\u0432\u0435\u0447\u0430\u0442\u044C \u043D\u0430 \u0437\u0430\u043F\u0440\u043E\u0441 \u0438\u0437 \u043A\u0435\u0448\u0430.</p></div><h3 id="options" tabindex="-1"><a class="header-anchor" href="#options" aria-hidden="true">#</a> Options</h3><table><thead><tr><th>\u041E\u043F\u0446\u0438\u044F</th><th>\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435</th><th>\u041F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E</th><th>\u041F\u0440\u0438\u043C\u0435\u0440 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F</th></tr></thead><tbody><tr><td><strong>path</strong></td><td>\u043E\u043F\u0438\u0441\u044B\u0432\u0430\u0435\u0442 uri \u043F\u0443\u0442\u044C, \u043D\u0430 \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u0434\u043E\u043B\u0436\u0435\u043D \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C\u0441\u044F \u0441\u043B\u043E\u0439, \u043C\u043E\u0436\u0440\u043E \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043B\u043E\u0432\u0430\u0442\u044C \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043A\u0438, \u0431\u0435\u0437 \u0443\u043A\u0430\u0437\u0430\u0440\u0438\u044F \u044D\u0442\u043E\u0433\u043E \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u0430 \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u0439 uri</td><td>-</td><td><code>/users/{id}</code></td></tr><tr><td><strong>name</strong></td><td>\u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u0435\u043C \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u043E\u0435 \u0438\u043C\u044F \u0441\u043B\u043E\u044F, \u0447\u0435\u0440\u0435\u0437 \u044D\u0442\u043E \u0438\u043C\u044F \u043C\u043E\u0436\u043D\u043E \u0431\u0443\u0434\u0435\u0442 \u043D\u0430\u0439\u0442\u0438 \u0441\u043B\u043E\u0439 (\u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E \u0432\u0441\u0435 \u0441\u043B\u043E\u0438 \u043F\u043E\u043B\u0443\u0447\u0430\u044E\u0442 \u0438\u043C\u0435\u043D\u0430 \u0432\u0438\u0434\u0430 <code>l-0</code>, <code>l-1</code> \u0438 \u0442.\u0434.)</td><td>-</td><td><code>usersAction</code></td></tr><tr><td><strong>methods</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 \u043C\u0430\u0441\u0441\u0438\u0432 \u0438\u0437 http \u043C\u0435\u0442\u043E\u0434\u043E\u0432, \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u0442\u043E\u043B\u044C\u043A\u043E \u043D\u0430 http \u0437\u0430\u043F\u0440\u043E\u0441\u044B \u0441 \u0443\u043A\u0430\u0437\u0430\u043D\u043D\u044B\u043C\u0438 http \u043C\u0435\u0442\u043E\u0434\u0430\u043C\u0438. \u0415\u0441\u043B\u0438 \u043C\u0435\u0442\u043E\u0434\u044B \u043D\u0435 \u043F\u0435\u0440\u0435\u0434\u0430\u043D\u044B, \u0442\u043E \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u0439 http \u043C\u0435\u0442\u043E\u0434</td><td><code>[]</code></td><td><code>[&#39;GET&#39;]</code></td></tr><tr><td><strong>priority</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 <code>int</code> \u0447\u0438\u0441\u043B\u043E \u0441 \u043F\u0440\u0438\u043E\u0440\u0438\u0442\u0435\u0442\u043E\u043C, \u0447\u0435\u043C \u043D\u0438 \u043C\u0435\u043D\u044C\u0448\u0435 \u0447\u0438\u0441\u043B\u043E, \u0442\u0435\u043C \u0440\u0430\u043D\u044C\u0448\u0435 \u0432\u044B\u043F\u043E\u043B\u043D\u0438\u0442\u0441\u044F \u0441\u043B\u043E\u0439. \u042D\u0442\u043E \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u043B\u043E\u0438 \u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u043E, \u043D\u0435 \u0432 \u043F\u043E\u0440\u044F\u0434\u043A\u0435 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F</td><td><code>50</code></td><td><code>100</code></td></tr><tr><td><strong>restrictions</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 \u043C\u0430\u0441\u0441\u0438\u0432 \u0432\u0438\u0434\u0430 [&#39;id&#39; =&gt; \\id+], \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u044F \u043D\u0430\u043A\u043B\u0430\u0434\u044B\u0432\u0430\u0442\u044C \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F \u043D\u0430 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B \u0432 uri \u0437\u0430\u043F\u0440\u043E\u0441\u0430</td><td><code>[]</code></td><td><code>[&#39;id&#39;=&gt;&#39;\\id+&#39;]</code></td></tr><tr><td><strong>contenxt</strong></td><td>\u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043F\u0440\u0438\u043A\u0440\u0435\u043F\u0438\u0442\u044C \u043A \u0441\u043B\u043E\u044E \u043B\u044E\u0431\u044B\u0435 \u043F\u0440\u043E\u0438\u0437\u0432\u043E\u043B\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435</td><td><code>[]</code></td><td><code>[&#39;foo&#39;=&gt;&#39;bar&#39;]</code></td></tr></tbody></table><p>\u041F\u0440\u0438\u043C\u0435\u0440 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u044F options \u0432 \u043A\u043E\u0434\u0435:</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>Context<span class="token punctuation">\\</span>ContextInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>HttpMethodEnum</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>MicroApp</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Psr7<span class="token punctuation">\\</span>Response<span class="token punctuation">\\</span>JsonResponse</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Psr7<span class="token punctuation">\\</span>ServerRequest</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Psr7<span class="token punctuation">\\</span>Uri</span><span class="token punctuation">;</span>

<span class="token keyword">require_once</span> <span class="token string single-quoted-string">&#39;../../../vendor/autoload.php&#39;</span><span class="token punctuation">;</span>

<span class="token variable">$psr7Request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerRequest</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;GET&#39;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Uri</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/hello/alex/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$app</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MicroApp</span><span class="token punctuation">;</span>

<span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">store</span><span class="token operator">-&gt;</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token class-name type-declaration">ContextInterface</span> <span class="token variable">$ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$ctx</span><span class="token operator">-&gt;</span><span class="token function">getCurrentLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token property">uriParams</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$ctx</span><span class="token operator">-&gt;</span><span class="token property">response</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JsonResponse</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;message&#39;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$name</span><span class="token punctuation">}</span></span>!&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;path&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;/hello/{name}/&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;helloWorldAction&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;priority&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;methods&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token class-name static-context">HttpMethodEnum</span><span class="token operator">::</span><span class="token constant">GET</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;restrictions&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;[a-zA-Z0-9]+&#39;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$psr7Response</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token variable">$psr7Request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u0431\u044B\u0441\u0442\u0440\u044B\u0435-http-\u043C\u0435\u0442\u043E\u0434\u044B-\u0441\u0430\u0445\u0430\u0440" tabindex="-1"><a class="header-anchor" href="#\u0431\u044B\u0441\u0442\u0440\u044B\u0435-http-\u043C\u0435\u0442\u043E\u0434\u044B-\u0441\u0430\u0445\u0430\u0440" aria-hidden="true">#</a> \u0411\u044B\u0441\u0442\u0440\u044B\u0435 http \u043C\u0435\u0442\u043E\u0434\u044B (\u0441\u0430\u0445\u0430\u0440)</h3><p>\u0414\u043B\u044F \u0443\u043F\u0440\u043E\u0449\u0435\u043D\u0438\u044F \u0442\u0430\u043A\u0436\u0435 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B \u043C\u0435\u0442\u043E\u0434\u044B, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0437\u0435\u0440\u043A\u0430\u043B\u0438\u0440\u0443\u044E\u0442 \u043E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 http \u043C\u0435\u0442\u043E\u0434\u044B, \u043D\u0430\u043F\u0440\u0438\u043C\u0435\u0440:</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">store</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/users/{id}/&#39;</span><span class="token punctuation">,</span> <span class="token keyword">fn</span><span class="token punctuation">(</span><span class="token variable">$ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">$ctx</span><span class="token operator">-&gt;</span><span class="token property">response</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JsonResponse</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">store</span><span class="token operator">-&gt;</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/users/{id}/&#39;</span><span class="token punctuation">,</span> <span class="token keyword">fn</span><span class="token punctuation">(</span><span class="token variable">$ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">store</span><span class="token operator">-&gt;</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/users/{id}/&#39;</span><span class="token punctuation">,</span> <span class="token keyword">fn</span><span class="token punctuation">(</span><span class="token variable">$ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">store</span><span class="token operator">-&gt;</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/users/{id}/&#39;</span><span class="token punctuation">,</span> <span class="token keyword">fn</span><span class="token punctuation">(</span><span class="token variable">$ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">store</span><span class="token operator">-&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/users/{id}/&#39;</span><span class="token punctuation">,</span> <span class="token keyword">fn</span><span class="token punctuation">(</span><span class="token variable">$ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">\u0411\u044B\u0441\u0442\u0440\u044B\u0435 \u043C\u0435\u0442\u043E\u0434\u044B</p><p>\u041F\u043E\u043B\u043D\u044B\u0439 \u0441\u043F\u0438\u0441\u043E\u043A \u043C\u0435\u0442\u043E\u0434\u043E\u0432 \u043C\u043E\u0436\u043D\u043E \u043D\u0430\u0439\u0442\u0438 \u0432 \u0442\u0440\u0435\u0439\u0442\u0435 <code>PTS\\Next2\\Layer\\Store\\FastMethodsTrait</code>. \u041E\u043D \u0440\u0435\u0430\u043B\u0438\u0437\u0443\u0435\u0442 \u0441\u0430\u043C\u044B\u0435 \u043F\u043E\u043F\u0443\u043B\u044F\u0440\u043D\u044B\u0435 \u043C\u0435\u0442\u043E\u0434\u044B. \u0412\u044B \u043C\u043E\u0436\u0435\u0442\u0435 \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0432\u043E\u0438 \u043C\u0435\u0442\u043E\u0434\u044B \u0434\u043B\u044F \u0441\u0430\u0445\u0430\u0440\u0430</p></div><h3 id="\u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F-\u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F" tabindex="-1"><a class="header-anchor" href="#\u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F-\u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F" aria-hidden="true">#</a> \u0414\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F \u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F</h3><p>\u041E\u0447\u0435\u043D\u044C \u0443\u0434\u043E\u0431\u043D\u043E \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043C\u0430\u0440\u0433\u0440\u0443\u0442\u044B \u0438 \u043F\u043E\u0440\u044F\u0434\u043E \u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u043E, \u043D\u0430\u043F\u0440\u0438\u043C\u0435\u0440 \u043F\u043E\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043E\u043C yml \u0444\u0430\u0439\u043B\u043E\u0432, \u043F\u0440\u043E\u0441\u0442\u043E\u0439 \u043F\u0440\u0438\u043C\u0435\u0440 \u0442\u0430\u043A\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u0442\u0430\u043A:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># middlewares</span>
<span class="token key atrule">ThrowableToResponse</span><span class="token punctuation">:</span>
  <span class="token key atrule">controller</span><span class="token punctuation">:</span> Site\\Middleware\\ThrowableToResponse<span class="token punctuation">:</span>process

<span class="token comment"># 404 page</span>
<span class="token key atrule">otherwise</span><span class="token punctuation">:</span>
  <span class="token key atrule">handler</span><span class="token punctuation">:</span> Site\\Controller\\Action\\Page404<span class="token punctuation">:</span>__invoke
  <span class="token key atrule">name</span><span class="token punctuation">:</span> otherwise
  <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token number">10000</span>

<span class="token comment"># actions</span>
<span class="token key atrule">main</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /
  <span class="token key atrule">methods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&#39;GET&#39;</span> <span class="token punctuation">]</span>
  <span class="token key atrule">handler</span><span class="token punctuation">:</span> Site\\Controller\\OtherwiseController<span class="token punctuation">:</span>mainPage

<span class="token key atrule">posts</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /post/
  <span class="token key atrule">methods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&#39;GET&#39;</span> <span class="token punctuation">]</span>
  <span class="token key atrule">handler</span><span class="token punctuation">:</span> Site\\Controller\\PostController<span class="token punctuation">:</span>getList

<span class="token key atrule">cat</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /cat/<span class="token punctuation">{</span>id<span class="token punctuation">}</span>/
  <span class="token key atrule">restrictions</span><span class="token punctuation">:</span>
    <span class="token key atrule">id</span><span class="token punctuation">:</span> &quot;&quot;\\d+&quot;
  <span class="token key atrule">methods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&#39;GET&#39;</span> <span class="token punctuation">]</span>
  <span class="token key atrule">handler</span><span class="token punctuation">:</span> Site\\Controller\\CategoryController<span class="token punctuation">:</span>getCat
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="flow" tabindex="-1"><a class="header-anchor" href="#flow" aria-hidden="true">#</a> Flow</h3><p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043E\u0439 \u043C\u043E\u0436\u0435\u0442 \u0447\u0442\u043E-\u0442\u043E \u0434\u0435\u043B\u0430\u0442\u044C \u0434\u043E \u0432\u044B\u0437\u043E\u0432\u0430 <code>$next()</code> \u043D\u0430 \u044D\u0442\u0430\u043F\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u0430, \u0442\u0430\u043A\u0436\u0435 \u043C\u043E\u0436\u0435\u0442 \u0447\u0442\u043E-\u0442\u043E \u0434\u0435\u043B\u0430\u0442\u044C \u043F\u043E\u0441\u043B\u0435 \u0432\u044B\u0437\u043E\u0432\u0430 <code>$next()</code> \u043D\u0430 \u044D\u0442\u0430\u043F\u0435 \u043E\u0442\u0432\u0435\u0442\u0430. \u041F\u0440\u0438\u043C\u0435\u0440 \u043F\u043E\u043B\u043D\u043E\u0433\u043E \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u043F\u0440\u043E\u0441\u0430, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043F\u0440\u043E\u0445\u043E\u0434\u0438\u0442 \u0441\u043A\u0432\u043E\u0437\u044C \u0432\u0441\u0435 \u0441\u043B\u043E\u0438:</p><p><img src="`+u+'" alt="200 flow"></p><p>\u041F\u0440\u0438\u043C\u0435\u0440 flow, \u043A\u043E\u0433\u0430 \u0437\u0430\u043F\u0440\u043E\u0441 \u0434\u043E\u0441\u0440\u043E\u0447\u043D\u043E \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0430\u043D \u043E\u0434\u043D\u0438\u043C \u0438\u0437 \u0441\u043B\u043E\u0435\u0432, \u0431\u0435\u0437 \u0432\u044B\u0437\u043E\u0432\u0430 <code>$next()</code>:</p><p><img src="'+d+`" alt="401 flow"></p><p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043Eq \u0440\u0435\u0448\u0430\u0435\u0442 \u0441\u0430\u043C, \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0438 \u043F\u0440\u0435\u043A\u0442\u0430\u0442\u0438\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443, \u043B\u0438\u0431\u043E \u0432\u044B\u0437\u0432\u0430\u0442\u044C \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u0441\u043B\u043E\u0439 \u0438 \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0435\u043C\u0443 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443.</p><h2 id="psr-15-middleware" tabindex="-1"><a class="header-anchor" href="#psr-15-middleware" aria-hidden="true">#</a> PSR-15 Middleware</h2><h3 id="\u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F" tabindex="-1"><a class="header-anchor" href="#\u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F" aria-hidden="true">#</a> \u0418\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F</h3><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u0443\u0435\u0442 \u0438\u043D\u0442\u0435\u0440\u0444\u0435\u0439\u0441 <code>Psr\\Http\\Server\\RequestHandlerInterface</code> \u0438\u0437 <code>PSR-15</code>. \u0417\u0430 \u0441\u0447\u0435\u0442 \u044D\u0442\u043E\u0433\u043E \u043E\u043D\u043E \u043C\u043E\u0436\u0435\u0442 \u0438\u043D\u0442\u0435\u0433\u0440\u0438\u0440\u043E\u0432\u0442\u044C\u0441\u044F \u0432 \u043B\u044E\u0431\u043E\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u043A\u0430\u043A middleware, \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044F \u043D\u0430 \u0432\u0445\u043E\u0434 <code>PSR7 Request</code> \u0438 \u0432\u043E\u0437\u0432\u0440\u0430\u0449\u0430\u044F <code>PSR7 Response</code>.</p><p>\u0421\u0445\u0435\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u044D\u0442\u043E \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u043A\u0430\u043A <code>psr15</code> -&gt; <code>psr15</code> -&gt; <code>next2</code>.</p><hr><p>\u0415\u0441\u043B\u0438 \u043C\u0438\u043A\u0440\u043E \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0434\u043E\u043B\u0436\u043D\u043E \u0434\u0435\u0440\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u0434\u0430\u043B\u0435\u0435 \u0432 \u043A\u043B\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043A\u0443\u044E <code>PSR-15 Middleware</code>, \u0442\u043E \u043C\u043E\u0436\u043D\u043E \u043E\u0431\u0435\u0440\u043D\u0443\u0442\u044C \u0432 \u0442\u0430\u043A\u0443\u044E middleware:</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code>
<span class="token keyword">use</span> <span class="token package">Psr<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Message<span class="token punctuation">\\</span>ResponseInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Psr<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Message<span class="token punctuation">\\</span>ServerRequestInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Psr<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Server<span class="token punctuation">\\</span>MiddlewareInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Psr<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Server<span class="token punctuation">\\</span>RequestHandlerInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>Context<span class="token punctuation">\\</span>Context</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>Layer<span class="token punctuation">\\</span>Layer</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>MicroApp</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PTS<span class="token punctuation">\\</span>Next2<span class="token punctuation">\\</span>Runner<span class="token punctuation">\\</span>Psr7Runner</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">NextMiddleware</span> <span class="token keyword">implements</span> <span class="token class-name">MiddlewareInterface</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/** <span class="token keyword">@var</span> <span class="token class-name">Layer<span class="token punctuation">[</span><span class="token punctuation">]</span></span> */</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">array</span> <span class="token variable">$layers</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token class-name type-declaration">Psr7Runner</span> <span class="token variable">$runner</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token class-name type-declaration">MicroApp</span> <span class="token variable">$app</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">layers</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">store</span><span class="token operator">-&gt;</span><span class="token function">getLayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">runner</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Psr7Runner</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">process</span><span class="token punctuation">(</span><span class="token class-name type-declaration">ServerRequestInterface</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">RequestHandlerInterface</span> <span class="token variable">$handler</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">ResponseInterface</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$adapterLayer</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Layer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Context</span> <span class="token variable">$ctx</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$handler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token variable">$handler</span><span class="token operator">-&gt;</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token variable">$ctx</span><span class="token operator">-&gt;</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$ctx</span><span class="token operator">-&gt;</span><span class="token property">response</span> <span class="token operator">=</span> <span class="token variable">$response</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$layers</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">layers</span><span class="token punctuation">,</span> <span class="token variable">$adapterLayer</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">runner</span><span class="token operator">-&gt;</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token variable">$layers</span><span class="token punctuation">,</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$handler</span><span class="token operator">-&gt;</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u0421\u0445\u0435\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u044D\u0442\u043E \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u043A\u0430\u043A <code>psr15</code> -&gt; <code>psr15</code> -&gt; <code>next2</code> -&gt; <code>psr15</code>.</p><p>\u0422\u0430\u043A\u0438\u0435 \u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u044E\u0442 \u0442\u043E\u0447\u0435\u0447\u043D\u043E \u0437\u0430\u043C\u0435\u043D\u044F\u0442\u044C \u0447\u0430\u0441\u0442\u0438 \u0441\u0442\u0430\u0440\u043E\u0433\u043E \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F \u0438\u043B\u0438 \u043F\u0435\u0440\u0435\u043D\u043E\u0441\u0438\u0442\u044C \u043D\u0435\u0431\u043E\u043B\u044C\u0448\u0438\u043C\u0438 \u043A\u0443\u0441\u043E\u0447\u043A\u0430\u043C\u0438 \u0447\u0430\u0441\u0442\u044C \u0444\u0443\u043D\u043A\u0446\u0438\u043E\u043D\u0430\u043B\u0430.</p><h2 id="todo" tabindex="-1"><a class="header-anchor" href="#todo" aria-hidden="true">#</a> TODO</h2>`,29),bn=n("li",null,[s("\u043F\u043E\u0434\u0443\u043C\u0430\u0442\u044C \u043E \u043F\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0432 "),n("code",null,"$next()"),s(" \u0430\u0440\u0433\u0443\u043C\u0435\u043D\u0442\u043E\u0432, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043F\u0440\u0438\u0434\u0443\u0442 3+ \u0430\u0440\u0433\u0443\u043C\u0435\u043D\u0442\u0430\u043C\u0438 \u0432 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 handler. (\u041F\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u043F\u0440\u0438\u043C\u0435\u0440\u044B \u0432 koa)")],-1),gn=n("li",null,"\u043F\u043E\u0434\u0443\u043C\u0430\u0442\u044C \u043E\u0431 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u0438 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432 \u0434\u043E \u0440\u0435\u0433\u0443\u043B\u044F\u0434\u043A\u0438 [A-Za-z0-9_-])",-1),mn=s("\u043F\u043E\u0434\u0443\u043C\u0430\u0442\u044C \u043E \u0430\u0432\u0442\u043E\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044F\u0445 \u0438 \u0432\u0430\u043B\u0438\u0434\u0430\u0442\u043E\u0440\u0430\u0445 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432 \u0438\u0437 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u043A\u0430\u043A \u0432 koaJs router "),_n={href:"https://github.com/ZijianHe/koa-router#module_koa-router--Router+param",target:"_blank",rel:"noopener noreferrer"},yn=s("param");function wn(fn,xn){const e=c("RouterLink"),p=c("ExternalLinkIcon");return i(),r("div",null,[v,n("nav",h,[n("ul",null,[n("li",null,[a(e,{to:"#hello-world"},{default:t(()=>[b]),_:1})]),n("li",null,[a(e,{to:"#\u0433\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0438"},{default:t(()=>[g]),_:1})]),n("li",null,[a(e,{to:"#\u0441\u043B\u043E\u0438"},{default:t(()=>[m]),_:1}),n("ul",null,[n("li",null,[a(e,{to:"#handler"},{default:t(()=>[_]),_:1})]),n("li",null,[a(e,{to:"#options"},{default:t(()=>[y]),_:1})]),n("li",null,[a(e,{to:"#\u0431\u044B\u0441\u0442\u0440\u044B\u0435-http-\u043C\u0435\u0442\u043E\u0434\u044B-\u0441\u0430\u0445\u0430\u0440"},{default:t(()=>[w]),_:1})]),n("li",null,[a(e,{to:"#\u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F-\u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F"},{default:t(()=>[f]),_:1})]),n("li",null,[a(e,{to:"#flow"},{default:t(()=>[x]),_:1})])])]),n("li",null,[a(e,{to:"#psr-15-middleware"},{default:t(()=>[$]),_:1}),n("ul",null,[n("li",null,[a(e,{to:"#\u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F"},{default:t(()=>[q]),_:1})])])]),n("li",null,[a(e,{to:"#todo"},{default:t(()=>[P]),_:1})])])]),R,n("div",S,[T,n("p",null,[C,n("a",L,[M,a(p)]),H,n("a",N,[I,a(p)]),E,n("a",A,[J,a(p)]),G,n("a",O,[F,a(p)]),j])]),U,n("p",null,[V,n("a",W,[B,a(p)]),Z]),n("div",z,[D,n("p",null,[K,n("a",Q,[X,a(p)]),Y,nn,sn]),an,en]),tn,n("div",pn,[on,n("p",null,[cn,n("a",ln,[rn,a(p)]),un,n("a",dn,[kn,a(p)]),vn])]),hn,n("ul",null,[bn,gn,n("li",null,[mn,n("a",_n,[yn,a(p)])])])])}var qn=l(k,[["render",wn],["__file","index.html.vue"]]);export{qn as default};
